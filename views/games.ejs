<% include partials/head.ejs %>

<header class="header-section">
  <section>
    <div class="nav">
      <h3><%= tournamentLong %></h3>
    </div>
    <div class="header-tabs">
      <ul>
        <li class="active"><a href="#">Games</a></li>
        <li class=""><a href="/swiss-standings/<%= games[0].swiss_round_id %>">Rankings</a></li>
      </ul>
    </div>
  </section>
</header>

<section class="division-select">
  <a href="/games"><button <% if(tournamentShort === 'Mixed') { %> class="active" <% } %>>Mixed</button></a>
  <a href="/games/19747"><button <% if(tournamentShort === 'Women') { %> class="active" <% } %>>Women</button></a>
  <a href="/games/19746"><button  <% if(tournamentShort === 'Open') { %> class="active" <% } %>>Open</button></a>
</section>

<!-- Show pop up message after user updates game -->
<% if(locals.flashes) { %>
  <% var categories =  Object.keys(flashes); %>
  <% categories.forEach(function (cat) { %>
    <% flashes[cat].forEach(message => { %>
      <section class="flash-message boxshadow"> 
        <button id="close-message">close</button>
        <h2>Score Updated!</h2>
        <p><%= message %></p> 
      </section>
    <% }) %>
  <% }) %>
<% } %>

<section class="team-games">
    <h2>Round 1 - active games</h2>
    <ul class="gameslist">
      <% games.forEach(function (obj) { %>
      <li class="boxshadow">
        <h3 class="tournament-info">ROUND <%= obj.swiss_round.round_number %> - @<%= obj.tournament.name %></h3>
        <a href="/update/<%= obj.id %>" class="game" id="<%= obj.id %>">

          <div class="team1">
            <h4 <% winners.forEach(function (winner) { if (winner.short_name === obj.team_1.short_name) { %> class="game-winner" <% }}) %> >
              <%= obj.team_1.short_name %>
            </h4>
            <h4><span><%= obj.team_1_score %></span></h4>
          </div>

          <div class="info">
            <p> <b><%= h.moment(obj.start_time).format('dddd Do') %></b></p>
            <p> <b><%= new Date(obj.start_time).toString().substr(15,6) %></b></p>
          </div>

          <div class="team2">
            <h4 <% winners.forEach(function (winner) { if (winner.short_name === obj.team_2.short_name) { %> class="game-winner" <% }}) %>>
              <%= obj.team_2.short_name %>
            </h3>
            <h4><span><%= obj.team_2_score %></span></h4>
          </div>

        </a>
        <% if (obj.game_site.name) { %>
        <p class="game-location"><%= obj.game_site.name %></p>
        <% } %>
      </li>
      <% }) %>
    </ul>

    <h2>Round 2</h2>

</section>

<% include partials/footer.ejs %>
